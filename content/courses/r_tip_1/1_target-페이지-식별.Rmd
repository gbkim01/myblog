---
title: 1. Target 페이지 식별
date: '2020-08-01'
linktitle: 1. Target 페이지 식별
lastmod: '2020-08-01T20:43:47Z'
type: docs
draft: yes
weight: 1
menu:
  r_tip_1:
    parent: Contents
    weight: 1
output:
  blogdown::html_page:
    toc: true
    fig_caption: yes
    number_sections: yes
    df_print: kable
---

```{r include=FALSE}
knitr::opts_chunk$set(comment = ">>")
```

---


크롤링을 함에 있어서 가장 먼저 확인해야할 부분은 원하는 자료가 위치한 **웹 페이지 주소**를 정확하게 파악하는 것입니다. 물론 대부분은 브라우저 상단의 주소창을 확인하는 것만으로도 해당 목적을 달성할 수 있습니다. 그러나 세상 일이 그렇게 간단치는 않죠. 예외적인 상황이 많기 때문에 브라우저의 구조와 작동원리를 좀 더 자세히 살펴볼 필요가 있습니다.

인터넷을 통해 우리가 눈으로 확인하는 내용은  한 페이지의 문서에 불과합니다. 그러나 그 한 페이지의 문서를 실제로  웹브라우저에 구현하기 위해서는 매우 복잡한 작용이 진행되고 있습니다. 때문에 실제 우리가 가져와야 할 정보를 찾고 긁어오기 위해서는 브라우저 안에서 어떤 동작이 진행되고 있는지에 대한 약간의 이해가 필요합니다. 
한가지 예를 들어 살펴보겠습니다.  


# 페이지 속의 페이지

**네이버 증권**에서 [**KOSPI 지수 일별 시세**](https://finance.naver.com/sise/sise_index.nhn?code=KOSPI)의 
지난 10년치 기록을 가져온다고 가정해 봅시다. 처음 주소창에 [**네이버 증권 국내증시**](https://finance.naver.com/sise/sise_index.nhn?code=KOSPI)의 주소를 입력하고 해당 페이지로 이동^[이후의 웹 페이지에 대한 모든 설명은 **구글 크롬 브라우저**를 기준으로 합니다. 파이어폭스나 엣지브라우저에서도 동일한 기능을 제공하고 동일한 순서로 크롤링이 진행되지만 보통 인터넷 검색을 통해 얻을 수 있는 대부분의 팁이 크롬을 기준으로 하고 있기 때문에 크롬에 익숙해 지면 향후 혼자서 정보검색할 때에도 편리하다는 장점이 있습니다.] 한 후 
**`F12키`**^[웹 브라우저의 개발자도구를 표시합니다.]를 누르면 다음과 같은 화면을 확인할 수 있습니다.  


```{r figs1, fig.align='center', fig.cap="웹 페이지 구성", echo=FALSE}
knitr::include_graphics("https://user-images.githubusercontent.com/30010992/89721986-a1ffee80-da1e-11ea-9af8-c66eb549e81a.jpg")
```


Figure \@ref(fig:figs1)에서 KOSPI 일별 시세에 대한 정보는 페이지 하단의 **2번** 구역에 위치하고 있습니다. 가만히 살펴보니 첫 화면에서는 최근 6일에 대한 시세 정보만 제공하고 있네요. 최근 6일치 말고 그보다 더 전의 시세에 대한 기록을 찾아보려면 **3번**위치에 있는 페이지 숫자를 일일이 마우스로 클릭해야 합니다. 페이지 숫자를 클릭할때마다 예전 시세정보를 6일치씩 끊어서 볼 수 있도록 사이트가 구성되어 있습니다. 

근데 **3번**의 페이지를 누른다고 해서 **1번**주소창의 URL이 변경된다거나 그러지는 않습니다. **3번** 페이지를 클릭하면 새로운 일별시세 정보로 갱신되어 화면에는 나타나는데 주소창 URL은 그대로입니다. 즉, **1번** 주소표시줄만 봐서는 긁고자 하는 대상의 URL을 정확하게 알 수 없는 상황입니다. 이때 봐야할 곳이 웹브라우저의 **개발자도구**입니다. 

# 브라우저 개발자도구의 활용
## 개발자 도구의 **네트워크**에서 서버와 브라우저 사이에 오가는 신호를 확인하자! 
크롬에서 **`F12키`**를 누르면 개발자도구가 활성화 됩니다. Figure\@ref(fig:figs1)의 오른편 처럼 말입니다. 가장 처음 확인해봐야 할 것이 **4번** 위치의 **네트워크** 부분입니다. 인터넷을 할 때, 웹 브라우저를 통해 서버와 신호를 주고받는데 **네트워크** 에는 서버와 브라우저 사이에 오가는 모든 신호정보가 표시됩니다. 즉, 코스피 지수의 과거 시세 정보를 보기 위해 **3**번의 페이지 숫자를 클릭하여 시세 정보를 갱신하게 되면 그 신호 정보가 **네트워크**에 표시된다는 이야기 입니다.그럼 다시 코스피 시세정보의 URL을 어떻게 확인할 수 있는지 확인해 보도록 합니다. 

먼저 **3번** 에서 숫자 4를 클릭해 봅시다. 그러자 **6번**에 새롭게 서버에서 내려받는 정보가 하단으로 줄륵 표시되기 시작합니다. 새로 받은 신호정보를 위에서 부터 차근차근 보니 **7번**의 `sise_index_day.nhn?code=KOSPI&page=4`이 눈에 보이네요. 맨 앞에는 `sise_index`라고 적혀있고 뒤로는 `code=KOSPI`, `page=4`라는 단어가 보입니다. 누가 봐도 시세정보를 나타내는게 아닌가 싶을 정도로 명확하게 적혀있네요. 시험삼아 **3번** 에서 숫자 5부터 7까지 눌러보면서 다시 개발자도구에 올라오는 정보를 확인해봅시다. 차례대로 다음과 인덱스 주소를 확인할 수 있을 것입니다. 

- sise_index_day.nhn?code=KOSPI&page=5
- sise_index_day.nhn?code=KOSPI&page=6
- sise_index_day.nhn?code=KOSPI&page=7

뭔가 규칙성을 확인할 수 있지 않습니까? 맞습니다. `sise_index_day.nhn?code=KOSPI&` 까지는 동일하고 페이지 숫자를 누를 때마다 `page=5` 숫자만 바뀌는 것을 알 수 있습니다. 

## 그런데 **네트워크**에서 URL 주소는 도대체 어디에 있나?